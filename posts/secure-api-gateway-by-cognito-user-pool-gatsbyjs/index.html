<!DOCTYPE html>
<html lang='en' dir='auto'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Bài này giải thích về cách secure API Gateway enpoint bằng cách dùng Cognito User Pool Authorizer. '>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Secure API Gateway by AWS Cognito User Pool (in ReactJS based Gatsby App) • hoangmnsd'>
<meta property='og:description' content='Bài này giải thích về cách secure API Gateway enpoint bằng cách dùng Cognito User Pool Authorizer. '>
<meta property='og:url' content='https://hoangmnsd.github.io/posts/secure-api-gateway-by-cognito-user-pool-gatsbyjs/'>
<meta property='og:site_name' content='Hoang'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/7a4fb984a45dfe1129362728655c0b75?s=256'><meta property='article:section' content='posts'><meta property='article:tag' content='GatsbyJS'><meta property='article:tag' content='AWS'><meta property='article:tag' content='APIGateway'><meta property='article:tag' content='Cognito'><meta property='article:published_time' content='2021-07-31T09:53:45&#43;09:00'/><meta property='article:modified_time' content='2021-07-31T09:53:45&#43;09:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.85.0" />

  <title>Secure API Gateway by AWS Cognito User Pool (in ReactJS based Gatsby App) • hoangmnsd</title>
  <link rel='canonical' href='https://hoangmnsd.github.io/posts/secure-api-gateway-by-cognito-user-pool-gatsbyjs/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#ffcd00;}
</style>

  

</head>
<body class='page type-posts has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
      Hoang
      </a>
    </h2>
    <div class='desc'>
    Learn something new everyday 😋
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/posts/'>Posts</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='/tags/aci/' style='font-size:1.0344827586206897em'>ACI</a>
      </li><li>
        <a href='/tags/agent/' style='font-size:1em'>Agent</a>
      </li><li>
        <a href='/tags/ai/' style='font-size:1.1379310344827587em'>AI</a>
      </li><li>
        <a href='/tags/aisearch/' style='font-size:1em'>AISearch</a>
      </li><li>
        <a href='/tags/ajax/' style='font-size:1em'>Ajax</a>
      </li><li>
        <a href='/tags/aks/' style='font-size:1.103448275862069em'>AKS</a>
      </li><li>
        <a href='/tags/alexa/' style='font-size:1em'>Alexa</a>
      </li><li>
        <a href='/tags/algorithm/' style='font-size:1em'>Algorithm</a>
      </li><li>
        <a href='/tags/ansible/' style='font-size:1.103448275862069em'>Ansible</a>
      </li><li>
        <a href='/tags/apigateway/' style='font-size:1.0344827586206897em'>APIGateway</a>
      </li><li>
        <a href='/tags/apim/' style='font-size:1em'>APIM</a>
      </li><li>
        <a href='/tags/argocd/' style='font-size:1em'>Argocd</a>
      </li><li>
        <a href='/tags/astronomy/' style='font-size:1em'>Astronomy</a>
      </li><li>
        <a href='/tags/aws/' style='font-size:1.6551724137931034em'>AWS</a>
      </li><li>
        <a href='/tags/azure/' style='font-size:2em'>Azure</a>
      </li><li>
        <a href='/tags/azureappservice/' style='font-size:1em'>AzureAppService</a>
      </li><li>
        <a href='/tags/azurebot/' style='font-size:1em'>AzureBot</a>
      </li><li>
        <a href='/tags/azurefunction/' style='font-size:1em'>AzureFunction</a>
      </li><li>
        <a href='/tags/blog/' style='font-size:1.0689655172413792em'>Blog</a>
      </li><li>
        <a href='/tags/bmac/' style='font-size:1em'>BMAC</a>
      </li><li>
        <a href='/tags/budget/' style='font-size:1em'>Budget</a>
      </li><li>
        <a href='/tags/cassandra/' style='font-size:1em'>Cassandra</a>
      </li><li>
        <a href='/tags/certmanager/' style='font-size:1.0344827586206897em'>CertManager</a>
      </li><li>
        <a href='/tags/chatgpt/' style='font-size:1em'>ChatGPT</a>
      </li><li>
        <a href='/tags/ci/cd/' style='font-size:1.103448275862069em'>CI/CD</a>
      </li><li>
        <a href='/tags/circleci/' style='font-size:1em'>CircleCI</a>
      </li><li>
        <a href='/tags/cloudflare/' style='font-size:1em'>Cloudflare</a>
      </li><li>
        <a href='/tags/cnab/' style='font-size:1em'>CNAB</a>
      </li><li>
        <a href='/tags/cognito/' style='font-size:1.0344827586206897em'>Cognito</a>
      </li><li>
        <a href='/tags/contentsafetystudio/' style='font-size:1em'>ContentSafetyStudio</a>
      </li><li>
        <a href='/tags/datafactory/' style='font-size:1em'>DataFactory</a>
      </li><li>
        <a href='/tags/ddos/' style='font-size:1em'>DDOS</a>
      </li><li>
        <a href='/tags/design-pattern/' style='font-size:1em'>Design-Pattern</a>
      </li><li>
        <a href='/tags/discord/slack/' style='font-size:1em'>Discord/Slack</a>
      </li><li>
        <a href='/tags/dns/' style='font-size:1em'>DNS</a>
      </li><li>
        <a href='/tags/docker/' style='font-size:1.1724137931034484em'>Docker</a>
      </li><li>
        <a href='/tags/docker-compose/' style='font-size:1.0689655172413792em'>Docker-compose</a>
      </li><li>
        <a href='/tags/efk/' style='font-size:1.0344827586206897em'>EFK</a>
      </li><li>
        <a href='/tags/eks/' style='font-size:1em'>EKS</a>
      </li><li>
        <a href='/tags/eksctl/' style='font-size:1.0344827586206897em'>eksctl</a>
      </li><li>
        <a href='/tags/elasticsearch/' style='font-size:1.0689655172413792em'>ElasticSearch</a>
      </li><li>
        <a href='/tags/extension/' style='font-size:1em'>Extension</a>
      </li><li>
        <a href='/tags/externaldns/' style='font-size:1em'>ExternalDNS</a>
      </li><li>
        <a href='/tags/facebook/' style='font-size:1em'>Facebook</a>
      </li><li>
        <a href='/tags/fail2ban/' style='font-size:1em'>Fail2ban</a>
      </li><li>
        <a href='/tags/fastapi/' style='font-size:1em'>FastAPI</a>
      </li><li>
        <a href='/tags/fluentd/' style='font-size:1.0344827586206897em'>Fluentd</a>
      </li><li>
        <a href='/tags/flux/' style='font-size:1em'>Flux</a>
      </li><li>
        <a href='/tags/football/' style='font-size:1em'>Football</a>
      </li><li>
        <a href='/tags/gatsbyjs/' style='font-size:1.0689655172413792em'>GatsbyJS</a>
      </li><li>
        <a href='/tags/gcp/' style='font-size:1.0344827586206897em'>GCP</a>
      </li><li>
        <a href='/tags/geography/' style='font-size:1em'>Geography</a>
      </li><li>
        <a href='/tags/git/' style='font-size:1.0344827586206897em'>Git</a>
      </li><li>
        <a href='/tags/github/' style='font-size:1em'>Github</a>
      </li><li>
        <a href='/tags/githubactions/' style='font-size:1em'>GithubActions</a>
      </li><li>
        <a href='/tags/gitlab/' style='font-size:1.1379310344827587em'>Gitlab</a>
      </li><li>
        <a href='/tags/gke/' style='font-size:1.0689655172413792em'>GKE</a>
      </li><li>
        <a href='/tags/google/' style='font-size:1em'>Google</a>
      </li><li>
        <a href='/tags/googleappscripts/' style='font-size:1em'>GoogleAppScripts</a>
      </li><li>
        <a href='/tags/grafana/' style='font-size:1.1379310344827587em'>Grafana</a>
      </li><li>
        <a href='/tags/helm/' style='font-size:1.103448275862069em'>Helm</a>
      </li><li>
        <a href='/tags/homeassistant/' style='font-size:1.3793103448275863em'>HomeAssistant</a>
      </li><li>
        <a href='/tags/hugo/' style='font-size:1em'>Hugo</a>
      </li><li>
        <a href='/tags/iam/' style='font-size:1em'>IAM</a>
      </li><li>
        <a href='/tags/identitycenter/' style='font-size:1em'>IdentityCenter</a>
      </li><li>
        <a href='/tags/influxdb/' style='font-size:1em'>InfluxDB</a>
      </li><li>
        <a href='/tags/iot/' style='font-size:1em'>IoT</a>
      </li><li>
        <a href='/tags/iptables/' style='font-size:1.0344827586206897em'>Iptables</a>
      </li><li>
        <a href='/tags/javascript/' style='font-size:1em'>Javascript</a>
      </li><li>
        <a href='/tags/jquery/' style='font-size:1em'>Jquery</a>
      </li><li>
        <a href='/tags/kafka/' style='font-size:1em'>Kafka</a>
      </li><li>
        <a href='/tags/keel/' style='font-size:1em'>Keel</a>
      </li><li>
        <a href='/tags/keycloak/' style='font-size:1em'>Keycloak</a>
      </li><li>
        <a href='/tags/kibana/' style='font-size:1.0344827586206897em'>Kibana</a>
      </li><li>
        <a href='/tags/kubectl/' style='font-size:1em'>kubectl</a>
      </li><li>
        <a href='/tags/kubernetes/' style='font-size:1.6896551724137931em'>Kubernetes</a>
      </li><li>
        <a href='/tags/lambda/' style='font-size:1.1379310344827587em'>Lambda</a>
      </li><li>
        <a href='/tags/languagestudio/' style='font-size:1em'>LanguageStudio</a>
      </li><li>
        <a href='/tags/letsecrypt/' style='font-size:1em'>Letsecrypt</a>
      </li><li>
        <a href='/tags/letsencrypt/' style='font-size:1.0344827586206897em'>Letsencrypt</a>
      </li><li>
        <a href='/tags/llm/' style='font-size:1.0689655172413792em'>LLM</a>
      </li><li>
        <a href='/tags/locust/' style='font-size:1em'>Locust</a>
      </li><li>
        <a href='/tags/loganalytics/' style='font-size:1em'>LogAnalytics</a>
      </li><li>
        <a href='/tags/logging/' style='font-size:1em'>Logging</a>
      </li><li>
        <a href='/tags/logicapps/' style='font-size:1em'>LogicApps</a>
      </li><li>
        <a href='/tags/loki/' style='font-size:1.0689655172413792em'>Loki</a>
      </li><li>
        <a href='/tags/machinelearning/' style='font-size:1.0689655172413792em'>MachineLearning</a>
      </li><li>
        <a href='/tags/mcp/' style='font-size:1em'>MCP</a>
      </li><li>
        <a href='/tags/microsoft/' style='font-size:1.0344827586206897em'>Microsoft</a>
      </li><li>
        <a href='/tags/namecheap/' style='font-size:1em'>Namecheap</a>
      </li><li>
        <a href='/tags/nextcloud/' style='font-size:1em'>NextCloud</a>
      </li><li>
        <a href='/tags/nginx/' style='font-size:1.103448275862069em'>Nginx</a>
      </li><li>
        <a href='/tags/oauth2proxy/' style='font-size:1em'>Oauth2Proxy</a>
      </li><li>
        <a href='/tags/openai/' style='font-size:1em'>OpenAI</a>
      </li><li>
        <a href='/tags/openldap/' style='font-size:1em'>OpenLDAP</a>
      </li><li>
        <a href='/tags/openssl/' style='font-size:1em'>OpenSSL</a>
      </li><li>
        <a href='/tags/opentelemetry/' style='font-size:1em'>OpenTelemetry</a>
      </li><li>
        <a href='/tags/openwebui/' style='font-size:1em'>OpenwebUI</a>
      </li><li>
        <a href='/tags/oraclecloud/' style='font-size:1.0344827586206897em'>OracleCloud</a>
      </li><li>
        <a href='/tags/packer/' style='font-size:1em'>Packer</a>
      </li><li>
        <a href='/tags/postgresql/' style='font-size:1.0344827586206897em'>Postgresql</a>
      </li><li>
        <a href='/tags/prometheus/' style='font-size:1.0344827586206897em'>Prometheus</a>
      </li><li>
        <a href='/tags/promtail/' style='font-size:1.0344827586206897em'>Promtail</a>
      </li><li>
        <a href='/tags/proxy/' style='font-size:1em'>Proxy</a>
      </li><li>
        <a href='/tags/python/' style='font-size:1.206896551724138em'>Python</a>
      </li><li>
        <a href='/tags/qualys/' style='font-size:1em'>Qualys</a>
      </li><li>
        <a href='/tags/rabbitmq/' style='font-size:1em'>RabbitMQ</a>
      </li><li>
        <a href='/tags/rag/' style='font-size:1.0344827586206897em'>RAG</a>
      </li><li>
        <a href='/tags/raspberrypi/' style='font-size:1.1379310344827587em'>RaspberryPi</a>
      </li><li>
        <a href='/tags/reactjs/' style='font-size:1em'>ReactJS</a>
      </li><li>
        <a href='/tags/redis/' style='font-size:1em'>Redis</a>
      </li><li>
        <a href='/tags/remotion/' style='font-size:1em'>Remotion</a>
      </li><li>
        <a href='/tags/sagemaker/' style='font-size:1em'>SageMaker</a>
      </li><li>
        <a href='/tags/sam/' style='font-size:1em'>SAM</a>
      </li><li>
        <a href='/tags/selenium/' style='font-size:1em'>Selenium</a>
      </li><li>
        <a href='/tags/serverless/' style='font-size:1.0689655172413792em'>Serverless</a>
      </li><li>
        <a href='/tags/sonarqube/' style='font-size:1em'>Sonarqube</a>
      </li><li>
        <a href='/tags/speechservice/' style='font-size:1em'>SpeechService</a>
      </li><li>
        <a href='/tags/ssh-tunnel/' style='font-size:1em'>SSH-Tunnel</a>
      </li><li>
        <a href='/tags/ssl/' style='font-size:1em'>SSL</a>
      </li><li>
        <a href='/tags/sso/' style='font-size:1em'>SSO</a>
      </li><li>
        <a href='/tags/stable-diffusion/' style='font-size:1.0344827586206897em'>Stable-Diffusion</a>
      </li><li>
        <a href='/tags/streamlit/' style='font-size:1em'>Streamlit</a>
      </li><li>
        <a href='/tags/swag/' style='font-size:1.0344827586206897em'>Swag</a>
      </li><li>
        <a href='/tags/synapse/' style='font-size:1.0344827586206897em'>Synapse</a>
      </li><li>
        <a href='/tags/telegram/' style='font-size:1.0344827586206897em'>Telegram</a>
      </li><li>
        <a href='/tags/tempo/' style='font-size:1em'>Tempo</a>
      </li><li>
        <a href='/tags/test/' style='font-size:1em'>Test</a>
      </li><li>
        <a href='/tags/timecomplexity/' style='font-size:1em'>TimeComplexity</a>
      </li><li>
        <a href='/tags/traefik/' style='font-size:1em'>Traefik</a>
      </li><li>
        <a href='/tags/tunnel/' style='font-size:1em'>Tunnel</a>
      </li><li>
        <a href='/tags/ubuntu/' style='font-size:1.103448275862069em'>Ubuntu</a>
      </li><li>
        <a href='/tags/virtualbox/' style='font-size:1em'>VirtualBox</a>
      </li><li>
        <a href='/tags/vnet/' style='font-size:1em'>Vnet</a>
      </li><li>
        <a href='/tags/vouchproxy/' style='font-size:1em'>VouchProxy</a>
      </li><li>
        <a href='/tags/vpc/' style='font-size:1em'>VPC</a>
      </li><li>
        <a href='/tags/windows/' style='font-size:1.0689655172413792em'>Windows</a>
      </li><li>
        <a href='/tags/wsl/' style='font-size:1em'>WSL</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><line x1="3" y1="12" x2="21" y2="12" />
<line x1="3" y1="6" x2="21" y2="6" />
<line x1="3" y1="18" x2="21" y2="18" />
</svg>
</span>
  <span class='close'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><line x1="18" y1="6" x2="6" y2="18" />
<line x1="6" y1="6" x2="18" y2="18" />
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/posts/'>Posts</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>Home</a></li><li><a href='/posts/'>Posts</a></li><li><span>Secure API Gateway by AWS Cognito User Pool (in ReactJS based Gatsby App)</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Hoang</p><p class='desc site-desc'>Learn something new everyday 😋</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Secure API Gateway by AWS Cognito User Pool (in ReactJS based Gatsby App)</h1>
      
<p class='desc'>Bài này giải thích về cách secure API Gateway enpoint bằng cách dùng Cognito User Pool Authorizer. </p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
<line x1="16" y1="2" x2="16" y2="6" />
<line x1="8" y1="2" x2="8" y2="6" />
<line x1="3" y1="10" x2="21" y2="10" />
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2021-07-31T09:53:45&#43;09:00'>2021, Jul 31</time>
</span>

  <span class='byline'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1" />
<path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z" />
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/hoangmnsd'>hoangmnsd</a></span>
  
<span class='reading-time'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><circle cx="12" cy="12" r="10" />
<polyline points="12 6 12 12 15 15" />
</svg>
5 mins read
</span>


</div>


  </div>
</header>

  
  
<details class='container entry-toc'>
  <summary class='title'>
    <span>Table of Contents</span>
  </summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#giới-thiệu">Giới thiệu</a></li>
    <li><a href="#yêu-cầu">Yêu cầu</a></li>
    <li><a href="#cách-làm">Cách làm</a></li>
    <li><a href="#credit">CREDIT</a></li>
  </ul>
</nav>
</details>


  <div class='container entry-content'>
  <h1 id="giới-thiệu">Giới thiệu</h1>
<p>Bài này giải thích về cách secure API Gateway enpoint bằng cách dùng Cognito User Pool Authorizer.<br>
Frontend trong bài này sử dụng Reacjs nhé.<br>
API Gateway của AWS thì có 2 loại chia theo protocol: HTTP API và REST API (Bài này nói về REST API).</p>
<h1 id="yêu-cầu">Yêu cầu</h1>
<p>Các bạn cần có base kiến thức về ReactJS 1 chút, biết làm thế nào để viết 1 component, export nó ra như nào,
làm sao để apply authenticate vào Gatsby, cách viết 1 component, create pages, pass <code>props</code> qua các page, export page &hellip;</p>
<p>Đã tạo 1 Cognito User Pool,
các bạn nên hoàn thành hoặc đọc qua bài này trước để biết cách integrate AWS Cognito vào Gatsby website:<br>
<a href="../../posts/integrate-aws-cognito-to-gatsby-website/">Integrate AWS Cognito to Gatsby Website</a></p>
<p>Bạn cũng cần đã biết về cách config API Gateway REST, đã tạo được RESOURCES, METHOD và integrate được nó với Lambda function.</p>
<h1 id="cách-làm">Cách làm</h1>
<p>Backend của chúng ta chuẩn bị 1 hàm Lambda đơn giản như này:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-lambda.jpg" alt=""></p>
<p>Config trong API Gateway REST:<br>
Tạo 1 resource <code>/interact</code> và method POST cho nó<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-resources-interact.jpg" alt=""></p>
<p>method OPTION được tạo ra 1 cách tự động nên bạn ko cần động đến nó làm gì nhé.</p>
<p>Sau đó integrate nó với hàm Lambda mà chúng ta đã chuẩn bị ở trên
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-post-integrate-lambda.jpg" alt=""></p>
<p>Vào tab <code>Authorizers</code>, tạo 1 cái Authorizer, nhớ chọn Cognito User Pool mà bạn đã có, chú ý chỗ Token Source điền <code>Authorization</code> nhé:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-create0.jpg" alt=""></p>
<p>Quay lại tab <code>Resources</code>, chọn Method POST -&gt; Method Request, phần Authorization hãy chọn cái Authorizer mà bạn vừa tạo ở trên:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-resource-post.jpg" alt=""></p>
<p>Save xong thì quay lại, màn hình của resource <code>/interact</code> nó sẽ như này:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer1.jpg" alt=""></p>
<p>Enable CORS và deploy lại API Gateway:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-cors.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-deploy.jpg" alt=""></p>
<p>Trong code của Frontend thì cần đưa <code>token</code> vào trong header như sau, dưới đây là code cho 1 component. Tên file là <code>InteractRestApiGW.js</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>;

<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">useForm</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-hook-form&#39;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GATEWAY_URL</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://xxxxxxxxx.execute-api.us-east-1.amazonaws.com/dev/interact&#34;</span>; <span style="color:#75715e">// REST API Gateway (API has applied Authorizer already)
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msgFromLambda</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Nothing, something go wrong..&#34;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">InteractRestApiGW</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">token</span> }) =&gt; {
    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">submitted</span>, <span style="color:#a6e22e">setSubmitted</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">false</span>);
    
    <span style="color:#66d9ef">const</span> {
        <span style="color:#a6e22e">register</span>,
        <span style="color:#a6e22e">handleSubmit</span>,
        <span style="color:#a6e22e">setError</span>,
        <span style="color:#a6e22e">reset</span>,
        <span style="color:#a6e22e">formState</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">errors</span>, <span style="color:#a6e22e">isSubmitting</span> }
    } <span style="color:#f92672">=</span> <span style="color:#a6e22e">useForm</span>();

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">onSubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">data</span> =&gt; {
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span> {
                <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">myName</span>,
            }
        }

        <span style="color:#66d9ef">try</span> {
            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">GATEWAY_URL</span>, {
                <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;POST&#34;</span>,
                <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cors&#34;</span>,
                <span style="color:#a6e22e">contentType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
                <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">payload</span>),
                <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
                    <span style="color:#e6db74">&#34;Content-type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json; charset=UTF-8&#34;</span>,
                    <span style="color:#e6db74">&#34;Accept&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;application/json&#34;</span>,
                    <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">token</span>,
                }
            });
            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>();
            <span style="color:#a6e22e">msgFromLambda</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">text</span>
            <span style="color:#a6e22e">setSubmitted</span>(<span style="color:#66d9ef">true</span>);
            <span style="color:#a6e22e">reset</span>();
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
            <span style="color:#a6e22e">setError</span>(
                <span style="color:#e6db74">&#34;submit&#34;</span>,
                <span style="color:#e6db74">&#34;submitError&#34;</span>,
                <span style="color:#e6db74">`Oops! There seems to be an issue! </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">message</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
            );
        }
    };

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">showThankYou</span> <span style="color:#f92672">=</span> (
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msg-confirm&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Awesome</span><span style="color:#f92672">!</span> <span style="color:#a6e22e">Your</span> <span style="color:#a6e22e">command</span> <span style="color:#a6e22e">was</span> <span style="color:#a6e22e">sent</span>. <span style="color:#a6e22e">The</span> <span style="color:#a6e22e">response</span> <span style="color:#a6e22e">is</span><span style="color:#f92672">:</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt; </span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span>{{<span style="color:#a6e22e">fontWeight</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bold&#34;</span>}}<span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">msgFromLambda</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span>{{<span style="color:#a6e22e">fontSize</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;13px&#39;</span>}}<span style="color:#f92672">&gt;&lt;</span><span style="color:#a6e22e">i</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">If</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">response</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">Hello</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">name</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">Lambda</span>, <span style="color:#a6e22e">it</span> <span style="color:#a6e22e">means</span> <span style="color:#a6e22e">Backend</span> <span style="color:#a6e22e">recognized</span> <span style="color:#a6e22e">you</span>. <span style="color:#a6e22e">Congras</span><span style="color:#f92672">!</span>
                <span style="color:#a6e22e">Otherwise</span>, <span style="color:#a6e22e">please</span> <span style="color:#a6e22e">debug</span> <span style="color:#a6e22e">it</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">more</span> <span style="color:#a6e22e">detail</span>...<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/i&gt;&lt;/p&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;btn btn-info my-3&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{() =&gt; <span style="color:#a6e22e">setSubmitted</span>(<span style="color:#66d9ef">false</span>)}<span style="color:#f92672">&gt;</span>
                <span style="color:#a6e22e">Send</span> <span style="color:#a6e22e">another</span> <span style="color:#a6e22e">command</span><span style="color:#f92672">?</span>
            <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/button&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
    );

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">showSubmitError</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">msg</span> =&gt; <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msg-error&#34;</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">msg</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;;</span>

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">showForm</span> <span style="color:#f92672">=</span> (
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">form</span> <span style="color:#a6e22e">onSubmit</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleSubmit</span>(<span style="color:#a6e22e">onSubmit</span>)} <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">This</span> <span style="color:#a6e22e">text</span> <span style="color:#a6e22e">box</span> <span style="color:#a6e22e">send</span> <span style="color:#a6e22e">command</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">REST</span> <span style="color:#a6e22e">API</span> <span style="color:#a6e22e">Gateway</span> <span style="color:#a6e22e">URL</span>
                (<span style="color:#a6e22e">which</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">applied</span> <span style="color:#a6e22e">Cognito</span> <span style="color:#a6e22e">User</span> <span style="color:#a6e22e">Pool</span> <span style="color:#a6e22e">Authorizer</span> <span style="color:#a6e22e">already</span>.
                <span style="color:#a6e22e">It</span> <span style="color:#a6e22e">means</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">someone</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">URL</span>, <span style="color:#a6e22e">they</span> <span style="color:#a6e22e">still</span> <span style="color:#a6e22e">can</span> <span style="color:#a6e22e">not</span> <span style="color:#a6e22e">send</span> <span style="color:#a6e22e">requests</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">it</span> <span style="color:#a6e22e">unless</span> <span style="color:#a6e22e">they</span> <span style="color:#a6e22e">authenticated</span> <span style="color:#66d9ef">this</span> <span style="color:#a6e22e">page</span>)<span style="color:#f92672">:</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">label</span> <span style="color:#a6e22e">htmlFor</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myName&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span>
                    <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-control&#34;</span>
                    <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myName&#34;</span>
                    <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myName&#34;</span>
                    <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myName&#34;</span>
                    <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Your name&#34;</span>
                    {...<span style="color:#a6e22e">register</span>(<span style="color:#e6db74">&#34;myName&#34;</span>, {
                        <span style="color:#a6e22e">required</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Dont forget your name!&#34;</span>,
                    })}
                    <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">isSubmitting</span>}
                <span style="color:#f92672">/&gt;</span>
                {<span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">myName</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msg-error&#34;</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">myName</span>.<span style="color:#a6e22e">message</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;}</span>
            <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/label&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit-wrapper&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;btn btn-info my-3&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">isSubmitting</span>}<span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Send</span> <span style="color:#a6e22e">command</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/button&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/form&gt;</span>
    );

    <span style="color:#66d9ef">return</span> (
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container my-4&#34;</span><span style="color:#f92672">&gt;</span>
            {<span style="color:#a6e22e">errors</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">submit</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">showSubmitError</span>(<span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">submit</span>.<span style="color:#a6e22e">message</span>)}
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-side&#34;</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">submitted</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">showThankYou</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">showForm</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
    )
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">InteractRestApiGW</span>
</code></pre></div><p>Có thể các bạn sẽ tự hỏi <code>token</code> lấy đâu ra?<br>
Trả lời: Thì để có token này bạn cũng cần sửa nơi các bạn apply Authentication 1 chút.</p>
<p>Giả sử đây là code của Home Page (index.js) của bạn, như bạn thấy chúng ta đã import component <code>InteractRestApiGW</code> vừa tạo ra ở trên, sử dụng nó gần cuối đoạn code, và truyền biến <code>token</code> lấy từ <code>props</code> của quá trình authen đến Cognito:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">SignIn</span>, <span style="color:#a6e22e">SignOut</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;@hoangmnsd/gatsby-theme-amplify-cognito&#34;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">InteractRestApiGW</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../components/InteractRestApiGW&#39;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">PrivateSpace</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">props</span> =&gt; {
    <span style="color:#66d9ef">return</span> (
        (<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">authState</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;signedIn&#34;</span>) <span style="color:#f92672">?</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">SignIn</span> <span style="color:#a6e22e">authState</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">authState</span>} <span style="color:#f92672">/&gt;</span> <span style="color:#f92672">:</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">SignOut</span> <span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container about my-5&#34;</span><span style="color:#f92672">&gt;</span>
                    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h1</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;font-weight-bold&#34;</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Hello</span> <span style="color:#a6e22e">my</span> <span style="color:#a6e22e">friend</span>,<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/h1&gt;</span>
                    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h2</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">This</span> <span style="color:#a6e22e">space</span> <span style="color:#a6e22e">requires</span> <span style="color:#a6e22e">an</span> <span style="color:#a6e22e">authenticated</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/h2&gt;</span>
                    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">InteractRestApiGW</span> 
                        <span style="color:#a6e22e">token</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">authData</span>.<span style="color:#a6e22e">signInUserSession</span>.<span style="color:#a6e22e">idToken</span>.<span style="color:#a6e22e">jwtToken</span>}
                    <span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
    )
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">PrivateSpace</span>

</code></pre></div><p>Phần UI của đoạn code trên như sau:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-ui-reactjs.jpg" alt=""></p>
<p>Khi bạn nhập tên vào chỗ Your name, App sẽ gửi request đến API Gateway, trong header của request đó có token của bạn, token này bạn lấy được sau khi login bằng Cognito identity. Nếu ko có token đó, API Gateway sẽ ko trả về kết quả. Như vậy là secure rồi đúng ko?</p>
<p>API gửi tên bạn (vừa nhập vào) đến backend cho Lambda xử lý, Lambda trả về respone và gửi lại kết quả cho APIGateway, từ đó trả về cho bạn nội dung &ldquo;Hello <!-- raw HTML omitted --> from Lambda&rdquo; như hình sau:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-ui-reactjs-response.jpg" alt=""></p>
<p>Nói thì có vẻ khó hiểu, nhưng nhìn hình sau các bạn chắc sẽ thấy đơn giản:<br>
<img src="https://raw.githubusercontent.com/hoangmnsd/images-bucket/master/static/images/apigw-rest-cognito-uspool-authorizer-diagram.jpg" alt=""></p>
<p>Done!</p>
<h1 id="credit">CREDIT</h1>
<p><a href="https://seifi.org/reactjs/build-a-contact-form-in-gatsby-part-2-react-hook-form.html">https://seifi.org/reactjs/build-a-contact-form-in-gatsby-part-2-react-hook-form.html</a><br>
<a href="https://seifi.org/aws/build-a-contact-form-in-gatsby-part-1-aws-lambda-simple-email-service-and-api-gateway.html">https://seifi.org/aws/build-a-contact-form-in-gatsby-part-1-aws-lambda-simple-email-service-and-api-gateway.html</a><br>
<a href="https://github.com/bengladwell/inside-story">https://github.com/bengladwell/inside-story</a><br>
<a href="https://www.bengladwell.com/gatsby-site-with-authentication/">https://www.bengladwell.com/gatsby-site-with-authentication/</a></p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z" />
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/tech-tutorials/'>Tech-Tutorials</a></div>
<div class='tags'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z" />
<line x1="7" y1="7" x2="7" y2="7" />
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/gatsbyjs/'>GatsbyJS</a>, <a class='tag' href='/tags/aws/'>AWS</a>, <a class='tag' href='/tags/apigateway/'>APIGateway</a>, <a class='tag' href='/tags/cognito/'>Cognito</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/posts/integrate-aws-cognito-to-gatsby-website/'>
        <span aria-hidden='true'><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><line x1="20" y1="12" x2="4" y2="12" />
<polyline points="10 18 4 12 10 6" />
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Integrate AWS Cognito to Gatsby Website</a>
    </div><div class='next-entry sep-before'>
      <a href='/posts/enable-docker-command-for-ubuntu-subsytem-wsl/'>
        <span class='screen-reader-text'>Next post: </span>Run docker command from Ubuntu Subsystem of Windows (WSL)<span aria-hidden='true'>Next <svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><line x1="4" y1="12" x2="20" y2="12" />
<polyline points="14 6 20 12 14 18" />
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/hoangmnsd' target='_blank' rel='noopener me'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" />
</svg>
</a>
      </li><li>
        <a href='mailto:hoangmnsd@gmail.com' target='_blank' rel='noopener me'>
          <span class='screen-reader-text'>Contact via Email</span><svg
  class="icon"
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 24 24"
  stroke-linecap="round"
  stroke-linejoin="round"
  stroke-width="2"
  aria-hidden="true"
><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
<polyline points="22,6 12,13 2,6" />
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2019-2025 hoangmsnd </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

